<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ç¤¼æ¥å®¶åº­æ—¥</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@700&family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --lilly-red: #E1251B;
            --lilly-pink: #FBCFC8;
            --lilly-black: #212121;
            --lilly-green-light: #e0f2f1;
            --lilly-green-dark: #00796b;
        }
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #111827;
        }
        body {
            font-family: 'Inter', 'Helvetica Neue', 'Helvetica', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', 'å¾®è½¯é›…é»‘', Arial, sans-serif;
        }
        #app-container {
            width: 100%;
            height: 100%;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            position: relative; 
        }
        #app-container::-webkit-scrollbar {
            display: none;  
        }
        .font-ringside {
            font-family: 'Poppins', sans-serif;
            font-weight: 700;
        }
        .page {
            display: none;
            animation: fadeIn 0.5s;
            min-height: 100%;
            flex-direction: column;
            width: 100%;
            box-sizing: border-box;
            background-color: white;
        }
        .page.full-height {
             height: 100%;
        }
        .page-content {
            flex-grow: 1;
            padding: 1.5rem;
        }
        .sticky-footer {
            position: sticky;
            bottom: 0;
            background-color: white;
            padding: 0.75rem 1.5rem 1.5rem 1.5rem;
            border-top: 1px solid #e5e7eb;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        .custom-modal-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            backdrop-filter: blur(4px);
        }
        .custom-modal-overlay.visible {
            opacity: 1;
            pointer-events: auto;
        }
        .custom-modal-content {
            background: white;
            border-radius: 1rem;
            width: 90%;
            max-width: 780px; /* Enlarged by ~1.3x from 600px */
            transform: scale(0.95);
            transition: transform 0.3s ease;
            display: flex;
            padding: 0;
            overflow: hidden;
        }
        .custom-modal-overlay.visible .custom-modal-content {
             transform: scale(1);
        }
        .modal-image-container {
            width: 45%;
            flex-shrink: 0;
        }
        .modal-text-container {
            width: 55%;
            padding: 2rem;
            text-align: left;
            display: flex;
            flex-direction: column;
        }
        .custom-modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #333;
            margin-bottom: 1rem;
        }
        .custom-modal-text {
            color: #555;
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 1.5rem;
            flex-grow: 1;
        }

        @keyframes pulse-scale {
            0%, 100% {
                transform: scale(1);
                filter: drop-shadow(0 0 3px rgba(255, 255, 255, 0.7));
            }
            50% {
                transform: scale(1.1);
                filter: drop-shadow(0 0 10px rgba(255, 255, 255, 1));
            }
        }
        .map-hotspot {
            position: absolute;
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            animation: pulse-scale 2.5s infinite ease-in-out;
            transition: transform 0.2s;
        }
        .map-hotspot:hover {
            transform: scale(1.15);
        }
        .map-icon {
            width: 44px;
            height: 44px;
            background-color: rgba(251, 191, 36, 0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            border: 2px solid white;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        .map-label {
            margin-top: 5px;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 13px;
            font-weight: 500;
            white-space: nowrap;
        }
        .map-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.5), transparent);
            padding: 1rem 1.5rem;
            display: flex;
            justify-content: space-around;
            align-items: center;
            z-index: 50;
        }
        .map-nav-btn {
            background-color: rgba(255,255,255,0.9);
            color: #1f2937;
            border-radius: 16px;
            padding: 0.75rem 0;
            width: 120px;
            font-weight: 600;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(255,255,255,0.2);
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            transition: all 0.2s ease;
        }
        .map-nav-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.2);
        }

        .scratch-container {
            position: relative;
            width: 100%;
            cursor: crosshair;
            border-radius: 0.75rem;
            overflow: hidden;
        }
        .scratch-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10;
        }
        
        #explore-fab {
            position: fixed;
            top: 1.5rem;
            left: 50%;
            transform: translateX(-50%);
            z-index: 60;
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            animation: pulse-scale 2.0s infinite ease-in-out;
            filter: drop-shadow(0 0 10px rgba(245, 158, 11, 1));
        }
        
        #orientation-lock {
            display: none;
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: #111827;
            color: white;
            z-index: 9999;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        @media (orientation: portrait) {
            #orientation-lock {
                display: flex;
            }
            #app-container {
                display: none;
            }
        }

    </style>
</head>
<body>
    <div id="orientation-lock">
        <svg class="w-16 h-16 mb-4 transform rotate-90" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z" />
        </svg>
        <p class="text-lg font-semibold">ä¸ºäº†è·å¾—æœ€ä½³ä½“éªŒ</p>
        <p>è¯·æ—‹è½¬æ‚¨çš„è®¾å¤‡è‡³æ¨ªå±æ¨¡å¼</p>
    </div>

    <div id="app-container">
    </div>
    
    <div id="customModal" class="custom-modal-overlay">
        <div class="custom-modal-content">
            <div class="modal-image-container">
                <img data-id="modalImage" src="" class="w-full h-full object-cover">
            </div>
            <div class="modal-text-container">
                <h3 data-id="modalTitle" class="custom-modal-title font-ringside">æç¤º</h3>
                <p data-id="modalText" class="custom-modal-text">è¿™æ˜¯ä¸€ä¸ªæç¤ºä¿¡æ¯ã€‚</p>
                <button data-id="modalCloseBtn" class="w-full lilly-button font-bold py-3 px-4 rounded-lg mt-auto">å…³é—­</button>
            </div>
        </div>
    </div>

    <div id="exploreModal" class="custom-modal-overlay">
         <div class="custom-modal-content !p-6 !max-w-md !flex-col">
            <h3 class="custom-modal-title font-ringside">å¼€å¯ä½ çš„æ¢ç´¢ä¹‹æ—…ï¼</h3>
            <p class="custom-modal-text">ä¸‰å¤§ä¸»é¢˜ä¸–ç•Œï¼Œä¹è¶£å„ä¸ç›¸åŒã€‚é€‰æ‹©ä¸€ä¸ªï¼Œäº²æ‰‹æ­å¼€å®ƒçš„ç¥ç§˜é¢çº±å§ï¼</p>
            <div class="space-y-3 mt-4 w-full">
                <div data-action="showScratchPage" data-type="fun" class="p-4 bg-gradient-to-br from-yellow-200 to-amber-300 rounded-xl cursor-pointer text-left">
                    <h4 class="font-bold text-lg text-amber-800 font-ringside">ã€Œè¶£ã€Â· å¥‡æƒ³ä¸–ç•Œ</h4>
                    <p class="text-sm text-amber-700 mt-1">äº²è¿‘è‡ªç„¶ï¼Œæ”¾é£ç«¥å¿ƒï¼</p>
                </div>
                <div data-action="showScratchPage" data-type="win" class="p-4 bg-gradient-to-br from-red-200 to-rose-300 rounded-xl cursor-pointer text-left">
                    <h4 class="font-bold text-lg text-rose-800 font-ringside">ã€Œèµ¢ã€Â· å¡è·¯é‡Œæˆ˜åœº</h4>
                    <p class="text-sm text-rose-700 mt-1">å›¢é˜Ÿé›†ç»“ï¼Œä¸ºè£èª‰è€Œæˆ˜ï¼</p>
                </div>
                <div data-action="showScratchPage" data-type="diy" class="p-4 bg-gradient-to-br from-purple-200 to-violet-300 rounded-xl cursor-pointer text-left">
                    <h4 class="font-bold text-lg text-violet-800 font-ringside">ã€Œä½œã€Â· æ…¢æ—¶å…‰å·¥åŠ</h4>
                    <p class="text-sm text-violet-700 mt-1">é™ä¸‹å¿ƒï¼Œä¸å®¶äººå…±åˆ›æ¸©é¦¨ã€‚</p>
                </div>
            </div>
            <button data-action="closeExploreModal" class="w-full mt-6 bg-gray-200 text-gray-700 font-semibold py-3 px-4 rounded-lg">è¿”å›åœ°å›¾</button>
        </div>
    </div>

<template id="app-template">
    <div id="splashPage" class="page flex flex-col justify-end items-center text-center p-8 bg-cover bg-center" style="background-image: url('https://raw.githubusercontent.com/gaoshijun1983-collab/Lilly-H5/main/1.1%20%E5%BC%80%E5%B1%8F%E9%A1%B5%E4%B8%BB%E8%A7%86%E8%A7%89%EF%BC%881179%C3%972556%EF%BC%89.png'); height: 100%;">
        <button data-action="showPage" data-page="verificationPage" class="w-full max-w-xs bg-white text-red-600 font-bold py-4 px-4 rounded-full shadow-2xl transition-transform transform hover:scale-105 animate-pulse-slow mb-12 font-ringside">
             å¼€å¯å®¶åº­æ—¥ä¹‹æ—…
        </button>
    </div>

    <div id="verificationPage" class="page flex items-center justify-center p-6 bg-gray-50">
        <div class="bg-white rounded-2xl p-8 shadow-xl text-center w-full max-w-sm">
            <h2 class="text-3xl font-bold text-gray-800 mb-4 font-ringside" style="color: var(--lilly-red);">å‘˜å·¥èº«ä»½éªŒè¯</h2>
            <p class="text-gray-600 mb-6">è¯·è¾“å…¥æ‚¨çš„ä¿¡æ¯ä»¥ç»§ç»­</p>
            <div class="space-y-4">
                <input data-id="employeeIdInput" type="text" placeholder="å‘˜å·¥å·" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 transition">
                <input data-id="employeeNameInput" type="text" placeholder="å§“å" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 transition">
                <input data-id="employeePhoneInput" type="tel" placeholder="ç”µè¯" class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:ring-2 focus:ring-red-500 focus:border-red-500 transition">
            </div>
            <p data-id="verificationError" class="text-red-500 text-sm mt-2 h-5"></p>
            <button data-action="verifyEmployee" class="w-full lilly-button font-bold py-3 px-4 rounded-lg hover:opacity-90 transition-transform transform hover:scale-105 mt-4">
                éªŒè¯è¿›å…¥
            </button>
        </div>
    </div>
    
    <div id="mapPage" class="page full-height bg-cover bg-center" style="background-image: url('https://raw.githubusercontent.com/gaoshijun1983-collab/Lilly-H5/main/WechatIMG1398.jpg');">
        <div class="absolute top-4 left-4 p-3 bg-white/80 backdrop-blur-sm rounded-lg shadow-lg text-gray-700 max-w-xs animate-pulse-slow">
            <h2 class="font-bold font-ringside text-base text-lilly-red">ä¸€ä»½å¯ä»¥è§¦æ‘¸çš„å¿«ä¹åœ°å›¾</h2>
            <p class="text-xs mt-1">ç‚¹å‡»é—ªçƒçš„å›¾æ ‡ï¼Œæ¢ç´¢ä½ çš„ä¸“å±å®¶åº­æ—¥æ—¶å…‰ï¼</p>
        </div>
        
        <div class="relative w-full h-full">
            <div data-action="showPage" data-page="badmintonIntroPage" class="map-hotspot" style="top: 65%; left: 15%; animation-delay: 0.2s; transform: scale(1.1);">
                <div class="map-icon" style="width: 50px; height: 50px; font-size: 28px; background-color: #ef4444;">ğŸ¸</div>
                <div class="map-label" style="font-size: 14px; padding: 4px 12px;">ã€Œè°ç¾½äº‰é”‹ã€å¤§èµ›</div>
            </div>
            <div data-action="showHighlight" data-highlight="event" class="map-hotspot" style="top: 75%; left: 50%; transform: translateX(-50%);">
                <div class="map-icon">ğŸ’¥</div>
                <div class="map-label">å°–å«æå‡»èµ›</div>
            </div>
             <div data-action="showHighlight" data-highlight="crafts" class="map-hotspot" style="top: 40%; left: 18%; animation-delay: 0.4s; transform: scale(1.1);">
                <div class="map-icon" style="width: 50px; height: 50px; font-size: 28px; background-color: #a855f7;">ğŸ¨</div>
                <div class="map-label" style="font-size: 14px; padding: 4px 12px;">æ…¢æ—¶å…‰å·¥åŠ</div>
            </div>
            <div data-action="showHighlight" data-highlight="offroad" class="map-hotspot" style="top: 20%; left: 80%; animation-delay: 0.3s;">
                <div class="map-icon">ğŸš™</div>
                <div class="map-label">è¶Šé‡è½¦</div>
            </div>
             <div data-action="showHighlight" data-highlight="picking" class="map-hotspot" style="top: 45%; left: 80%;">
                <div class="map-icon">ğŸ§º</div>
                <div class="map-label">é‡‡æ‘˜ä¹å›­</div>
            </div>
            <div data-action="showHighlight" data-highlight="party" class="map-hotspot" style="top: 78%; left: 78%; animation-delay: 0.5s;">
                <div class="map-icon">ğŸ”¥</div>
                <div class="map-label">ç¯ç«æ´¾å¯¹</div>
            </div>
            <div data-action="showHighlight" data-highlight="fireworks" class="map-hotspot" style="top: 73%; left: 85%;">
                 <div class="map-icon">ğŸ†</div>
                 <div class="map-label">çƒŸèŠ±ç§€</div>
            </div>
        </div>

        <div id="explore-fab" data-action="openExploreModal">
            <div class="map-icon" style="width: 52px; height: 52px; font-size: 28px; background-color: #f59e0b;">ğŸ§­</div>
            <div class="map-label" style="font-size: 14px; padding: 4px 10px;">æ¢ç´¢å…¨åœº</div>
        </div>

        <nav class="map-nav">
            <button data-action="showPage" data-page="registrationPage" class="map-nav-btn">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg>
                <span>æŠ¥åå…¥å£</span>
            </button>
            <button data-action="showPhotoAlbum" class="map-nav-btn">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                <span>ç²¾å½©ç¬é—´</span>
            </button>
            <button data-action="showMyBookings" class="map-nav-btn">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 5v2m0 4v2m0 4v2M5 5a2 2 0 00-2 2v3a2 2 0 110 4v3a2 2 0 002 2h14a2 2 0 002-2v-3a2 2 0 110-4V7a2 2 0 00-2-2H5z"></path></svg>
                <span>æˆ‘çš„å‡­è¯</span>
            </button>
        </nav>
    </div>

    <div id="scratchPage" class="page">
        <div class="page-content">
            <h2 data-id="scratchTitle" class="text-3xl font-bold mb-2 font-ringside"></h2>
            <p class="text-gray-600 mb-4">æ“¦äº®è¿™ç‰‡åŒºåŸŸï¼Œçœ‹çœ‹è—ç€å“ªäº›å¥‡å¦™ä¹è¶£ï¼</p>
            
            <div data-id="scratchContainer" class="scratch-container">
                <canvas data-id="scratchCanvas" class="scratch-canvas"></canvas>
                <div data-id="scratchContent" class="p-4 bg-gray-50 rounded-lg">
                    <div data-id="activityListContainer" class="space-y-4">
                    </div>
                     <p class="text-center text-sm text-gray-500 mt-6 italic">æ˜¯ä¸æ˜¯å·²ç»å¿ƒåŠ¨äº†ï¼Ÿ<br>æ›´å¤šæœªçŸ¥çš„æƒŠå–œï¼ŒæœŸå¾…ä½ æ¥ç°åœºäº²è‡ªå‘ç°ï¼</p>
                </div>
            </div>
        </div>
         <div class="sticky-footer">
            <button data-action="closeScratchPage" class="w-full p-4 bg-gray-200 text-gray-700 rounded-xl text-center hover:bg-gray-300 transition font-semibold">è¿”å›æ¢ç´¢ä¹‹æ—…</button>
        </div>
    </div>
    
    <div id="registrationPage" class="page">
         <div class="page-content">
            <h2 class="text-3xl font-bold mb-6 font-ringside" style="color: var(--lilly-red);">æ´»åŠ¨æŠ¥å</h2>
            <div class="space-y-6">
                <div>
                    <label class="font-semibold text-gray-700">å‘˜å·¥ä¿¡æ¯ (æ‚¨æœ¬äºº)</label>
                    <div class="mt-2 p-4 bg-gray-100 rounded-lg">
                        <p><strong>å·¥å·:</strong> <span data-id="regEmployeeId"></span></p>
                        <p><strong>å§“å:</strong> <span data-id="regEmployeeName"></span></p>
                        <p><strong>ç”µè¯:</strong> <span data-id="regEmployeePhone"></span></p>
                    </div>
                </div>
                <div>
                    <label class="font-semibold text-gray-700">å®¶å±ä¿¡æ¯</label>
                    <div class="mt-2 p-4 border rounded-lg space-y-4">
                        <div data-id="familyFormsContainer" class="space-y-3"></div>
                        <button data-action="addFamilyMemberForm" class="w-full bg-gray-200 text-gray-700 font-semibold py-2 px-4 rounded-lg hover:bg-gray-300 transition text-sm">
                            + æ·»åŠ å®¶å±
                        </button>
                    </div>
                </div>
                <div>
                    <label class="font-semibold text-gray-700">ç”¨é¤å®‰æ’ (ä¸‰æ‰¹æ¬¡åˆ†æµ)</label>
                    <div class="space-y-2 mt-2">
                        <label class="flex items-center p-4 border rounded-lg has-[:checked]:bg-red-50 has-[:checked]:border-red-400">
                            <input type="radio" name="dining" value="17:00 - 17:40 (çº¢ç¥¨)" class="h-5 w-5" style="accent-color: var(--lilly-red);">
                            <span class="ml-3"><strong>æ‰¹æ¬¡ä¸€ (çº¢ç¥¨):</strong> 17:00 - 17:40</span>
                        </label>
                        <label class="flex items-center p-4 border rounded-lg has-[:checked]:bg-blue-50 has-[:checked]:border-blue-400">
                            <input type="radio" name="dining" value="17:40 - 18:20 (è“ç¥¨)" class="h-5 w-5" checked>
                            <span class="ml-3"><strong>æ‰¹æ¬¡äºŒ (è“ç¥¨):</strong> 17:40 - 18:20</span>
                        </label>
                        <label class="flex items-center p-4 border rounded-lg has-[:checked]:bg-yellow-50 has-[:checked]:border-yellow-400">
                            <input type="radio" name="dining" value="18:20 - 19:00 (é»„ç¥¨)" class="h-5 w-5">
                            <span class="ml-3"><strong>æ‰¹æ¬¡ä¸‰ (é»„ç¥¨):</strong> 18:20 - 19:00</span>
                        </label>
                    </div>
                </div>
                 <div>
                    <label class="font-semibold text-gray-700">å‡ºè¡Œæ–¹å¼</label>
                    <div class="flex gap-4 mt-2">
                         <label class="flex-1 flex items-center p-4 border rounded-lg has-[:checked]:bg-green-50 has-[:checked]:border-green-400">
                            <input type="radio" name="transport" value="å…¬å¸å¤§å·´" class="h-5 w-5 text-green-600">
                            <span class="ml-3">å…¬å¸å¤§å·´</span>
                        </label>
                         <label class="flex-1 flex items-center p-4 border rounded-lg has-[:checked]:bg-indigo-50 has-[:checked]:border-indigo-400">
                            <input type="radio" name="transport" value="è‡ªè¡Œå‰å¾€" class="h-5 w-5 text-indigo-600" checked>
                            <span class="ml-3">è‡ªè¡Œå‰å¾€</span>
                        </label>
                    </div>
                    <div data-id="transportDetails" class="mt-4"></div>
                </div>
                <button data-action="submitRegistration" class="w-full mt-8 lilly-button font-bold py-4 px-4 rounded-lg hover:opacity-90 transition-transform transform hover:scale-105">
                    ç¡®è®¤ä¿¡æ¯ï¼Œç”Ÿæˆæˆ‘çš„å‡ºå‘åˆ¸
                </button>
            </div>
        </div>
         <div class="sticky-footer">
            <button data-action="showPage" data-page="mapPage" class="w-full p-4 bg-gray-200 text-gray-700 rounded-xl text-center hover:bg-gray-300 transition font-semibold">
                è¿”å›åœ°å›¾é¦–é¡µ
            </button>
        </div>
    </div>
    
    <div id="successPage" class="page">
        <div class="page-content flex flex-col items-center justify-center text-center">
            <div class="w-24 h-24 rounded-full flex items-center justify-center mb-6 mx-auto" style="background-color: var(--lilly-green-light);">
                <svg class="w-16 h-16 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
            </div>
            <h2 class="text-3xl font-bold font-ringside" style="color: var(--lilly-red);">æŠ¥åæˆåŠŸ!</h2>
            <p class="text-gray-600 mt-2 mb-8">è¯·å‡­æ­¤ç”µå­åˆ¸åœ¨ç°åœºç­¾åˆ°ã€‚</p>
            <div class="bg-white p-4 rounded-lg shadow-md w-full max-w-xs">
                 <img data-id="qrCode" src="https://api.qrserver.com/v1/create-qr-code/?size=500x500&data=LillyFamilyDay-Default" alt="æ¨¡æ‹Ÿç­¾åˆ°äºŒç»´ç " class="w-full rounded-md">
                 <p class="mt-4 font-semibold text-lg" data-id="successName"></p>
                 <p class="text-sm text-gray-500" data-id="successId"></p>
            </div>
            <div data-id="allMyBookings" class="mt-6 text-left w-full max-w-xs bg-gray-50 p-4 rounded-lg">
            </div>
        </div>
         <div class="sticky-footer">
              <button data-action="showPage" data-page="mapPage" class="w-full p-4 lilly-button rounded-xl text-center hover:opacity-90 transition font-semibold">
                è¿”å›åœ°å›¾é¦–é¡µ
            </button>
        </div>
    </div>

    <div id="itemDetailPage" class="page">
        <div class="page-content">
            <img data-id="itemDetailImage" src="" class="w-full h-48 object-cover rounded-lg mb-4 shadow-md">
            <h2 data-id="itemDetailTitle" class="text-3xl font-bold mb-4 font-ringside"></h2>
            <p data-id="itemDetailDescription" class="text-gray-600 leading-relaxed"></p>
            <div class="mt-6 bg-gray-100 p-4 rounded-lg">
                <h3 class="font-bold text-lg text-gray-800 mb-2">è§„åˆ™è¶£è§£</h3>
                <p data-id="itemDetailRules" class="text-gray-600 text-sm"></p>
            </div>
        </div>
        <div class="sticky-footer">
            <button data-id="itemDetailBackButton" data-action="showScratchPage" class="w-full p-4 bg-gray-200 text-gray-700 rounded-xl text-center hover:bg-gray-300 transition font-semibold">è¿”å›åˆ—è¡¨</button>
        </div>
    </div>
    
    <div id="badmintonIntroPage" class="page">
        <div class="page-content">
            <img src="https://images.unsplash.com/photo-1620246233762-2f618f2191b4?q=80&w=2564&auto=format&fit=crop" alt="ç¾½æ¯›çƒå¤§èµ›ä¸»å›¾" class="w-full h-40 object-cover rounded-lg mb-4 shadow-md">
            <h2 class="text-3xl font-bold font-ringside" style="color: var(--lilly-red);">ã€Œè°ç¾½äº‰é”‹ã€ç¾½æ¯›çƒå¤§èµ›</h2>
            <p class="text-sm text-gray-500 mb-4">åé¢æœ‰é™ï¼Œå…ˆåˆ°å…ˆå¾—ï¼</p>
            <div class="text-gray-700 space-y-2 mb-6 text-sm">
                <p><strong>æ¯”èµ›æ—¶é—´ï¼š</strong>ä¸‹åˆ</p>
                <p><strong>æ¯”èµ›é¡¹ç›®ï¼š</strong>ç”·å­å•æ‰“ã€å¥³å­å•æ‰“ã€æ··åˆåŒæ‰“</p>
                <p><strong>æŠ¥åé¡»çŸ¥ï¼š</strong>æ‰€æœ‰å‘˜å·¥åŠå®¶å±å‡å¯æŠ¥åã€‚æ··åŒé¡¹ç›®å¯ä¸ºæ‚¨çš„æ­æ¡£ä»£å¡«èµ„æ–™ã€‚</p>
            </div>
            <h3 class="text-xl font-bold text-gray-800 mb-4 font-ringside">æ¯”èµ›æŠ¥åé€šé“</h3>
            <div class="space-y-4">
                <div data-action="showBadmintonRegPage" data-page="badmintonRegisterPage_mens" class="flex items-center justify-between bg-blue-100 p-4 rounded-lg cursor-pointer hover:bg-blue-200">
                    <div><p class="font-bold text-blue-800 font-ringside">ç”·å­å•æ‰“</p><p class="text-sm text-blue-700">è‹±é›„é›†ç»“ï¼Œä¸€æˆ˜å°ç‹</p></div>
                    <div class="text-right text-sm"><p class="font-semibold text-blue-800">å·²æŠ¥å: <span data-id="mens_count">0</span></p><p class="text-xs text-blue-600">å‰©ä½™: <span data-id="mens_remain">16</span></p></div>
                </div>
                <div data-action="showBadmintonRegPage" data-page="badmintonRegisterPage_womens" class="flex items-center justify-between bg-pink-100 p-4 rounded-lg cursor-pointer hover:bg-pink-200">
                    <div><p class="font-bold text-pink-800 font-ringside">å¥³å­å•æ‰“</p><p class="text-sm text-pink-700">é“¿é”µç«ç‘°ï¼Œèµ›åœºç»½æ”¾</p></div>
                    <div class="text-right text-sm"><p class="font-semibold text-pink-800">å·²æŠ¥å: <span data-id="womens_count">0</span></p><p class="text-xs text-pink-600">å‰©ä½™: <span data-id="womens_remain">16</span></p></div>
                </div>
                <div data-action="showBadmintonRegPage" data-page="badmintonRegisterPage_mixed" class="flex items-center justify-between bg-purple-100 p-4 rounded-lg cursor-pointer hover:bg-purple-200">
                    <div><p class="font-bold text-purple-800 font-ringside">æ··åˆåŒæ‰“</p><p class="text-sm text-purple-700">æœ€ä½³æ‹æ¡£ï¼Œé»˜å¥‘è‡´èƒœ</p></div>
                    <div class="text-right text-sm"><p class="font-semibold text-purple-800">å·²æŠ¥å: <span data-id="mixed_count">0</span></p><p class="text-xs text-purple-600">å‰©ä½™: <span data-id="mixed_remain">16</span></p></div>
                </div>
            </div>
        </div>
        <div class="sticky-footer">
            <button data-action="showPage" data-page="mapPage" class="w-full p-4 bg-gray-200 text-gray-700 rounded-xl text-center hover:bg-gray-300 transition font-semibold">è¿”å›åœ°å›¾é¦–é¡µ</button>
        </div>
    </div>

    <div id="badmintonRegisterPage_mens" class="page badminton-reg-page">
        <div class="page-content"><h2 class="text-3xl font-bold mb-6 font-ringside" style="color: var(--lilly-red);">ç”·å­å•æ‰“æŠ¥å</h2><form class="space-y-4" data-type="mens"><p class="text-sm text-gray-600">è¯·å¡«å†™æ‚¨çš„å‚èµ›ä¿¡æ¯ã€‚</p><input type="text" placeholder="å§“å" name="name1" class="w-full px-4 py-3 border-2 rounded-lg" required><input type="tel" placeholder="ç”µè¯" name="phone1" class="w-full px-4 py-3 border-2 rounded-lg" required><button type="submit" class="w-full mt-4 lilly-button font-bold py-3 rounded-lg hover:opacity-90">ç¡®è®¤æŠ¥å</button></form></div>
        <div class="sticky-footer"><button data-action="showPage" data-page="badmintonIntroPage" class="w-full p-4 bg-gray-200 text-gray-700 rounded-xl text-center hover:bg-gray-300 transition font-semibold">è¿”å›å¤§èµ›ä»‹ç»</button></div>
    </div>
    <div id="badmintonRegisterPage_womens" class="page badminton-reg-page">
        <div class="page-content"><h2 class="text-3xl font-bold mb-6 font-ringside" style="color: var(--lilly-red);">å¥³å­å•æ‰“æŠ¥å</h2><form class="space-y-4" data-type="womens"><p class="text-sm text-gray-600">è¯·å¡«å†™æ‚¨çš„å‚èµ›ä¿¡æ¯ã€‚</p><input type="text" placeholder="å§“å" name="name1" class="w-full px-4 py-3 border-2 rounded-lg" required><input type="tel" placeholder="ç”µè¯" name="phone1" class="w-full px-4 py-3 border-2 rounded-lg" required><button type="submit" class="w-full mt-4 lilly-button font-bold py-3 rounded-lg hover:opacity-90" style="background-color: #ec4899;">ç¡®è®¤æŠ¥å</button></form></div>
        <div class="sticky-footer"><button data-action="showPage" data-page="badmintonIntroPage" class="w-full p-4 bg-gray-200 text-gray-700 rounded-xl text-center hover:bg-gray-300 transition font-semibold">è¿”å›å¤§èµ›ä»‹ç»</button></div>
    </div>
    <div id="badmintonRegisterPage_mixed" class="page badminton-reg-page">
        <div class="page-content"><h2 class="text-3xl font-bold mb-6 font-ringside" style="color: var(--lilly-red);">æ··åˆåŒæ‰“æŠ¥å</h2><form class="space-y-6" data-type="mixed"><div><label class="font-semibold text-gray-700">é˜Ÿå‘˜ä¸€ä¿¡æ¯</label><div class="space-y-3 mt-2 p-4 border rounded-lg"><input type="text" placeholder="å§“å" name="name1" class="w-full px-4 py-3 border-2 rounded-lg" required><input type="tel" placeholder="ç”µè¯" name="phone1" class="w-full px-4 py-3 border-2 rounded-lg" required><select class="w-full px-4 py-3 border-2 rounded-lg bg-white" name="gender1" required><option value="" disabled selected>æ€§åˆ«</option><option>ç”·</option><option>å¥³</option></select></div></div><div><label class="font-semibold text-gray-700">é˜Ÿå‘˜äºŒä¿¡æ¯ (æ‚¨çš„æ­æ¡£)</label><div class="space-y-3 mt-2 p-4 border rounded-lg"><input type="text" placeholder="å§“å" name="name2" class="w-full px-4 py-3 border-2 rounded-lg" required><input type="tel" placeholder="ç”µè¯" name="phone2" class="w-full px-4 py-3 border-2 rounded-lg" required><select class="w-full px-4 py-3 border-2 rounded-lg bg-white" name="gender2" required><option value="" disabled selected>æ€§åˆ«</option><option>ç”·</option><option>å¥³</option></select></div></div><button type="submit" class="w-full mt-4 lilly-button font-bold py-3 rounded-lg hover:opacity-90" style="background-color: #a855f7;">ç¡®è®¤æŠ¥å</button></form></div>
        <div class="sticky-footer"><button data-action="showPage" data-page="badmintonIntroPage" class="w-full p-4 bg-gray-200 text-gray-700 rounded-xl text-center hover:bg-gray-300 transition font-semibold">è¿”å›å¤§èµ›ä»‹ç»</button></div>
    </div>
    
    <div id="badmintonSuccessPage" class="page">
        <div class="page-content text-center flex flex-col items-center justify-center">
             <div class="w-24 h-24 rounded-full flex items-center justify-center mb-6 mx-auto" style="background-color: var(--lilly-green-light);"><svg class="w-16 h-16 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div>
            <h2 class="text-3xl font-bold font-ringside" style="color: var(--lilly-red);">å¤§èµ›æŠ¥åæˆåŠŸ!</h2>
            <p class="text-gray-600 mt-2 mb-8">æ¯”èµ›ä¿¡æ¯å·²è®°å½•ï¼Œç°åœºå‡­å§“åç­¾åˆ°ã€‚</p>
            <div data-id="b-success-info" class="text-left w-full max-w-xs bg-gray-50 p-4 rounded-lg"></div>
        </div>
        <div class="sticky-footer space-y-2">
            <button data-action="showPage" data-page="badmintonIntroPage" class="w-full p-4 lilly-button rounded-xl text-center hover:opacity-90 transition font-semibold">è¿”å›å¤§èµ›ä»‹ç»</button>
            <button data-action="showMyBookings" class="w-full p-4 bg-gray-200 text-gray-800 rounded-xl text-center hover:bg-gray-300 transition font-semibold">æŸ¥çœ‹æˆ‘çš„æ‰€æœ‰æŠ¥å</button>
        </div>
    </div>
</template>

<script>
    const HIGHLIGHT_DATA = {
        event: { title: "ç™¾äººå¼€å›¢ï¼Œå°–å«æå‡»ï¼", text: "å¿˜æ‰æ‹˜æŸï¼Œé‡Šæ”¾å¤©æ€§ï¼å·¨å‹é“å…·å’Œè¶£å‘³è§„åˆ™ï¼Œè®©æ¯ä¸ªäººéƒ½èƒ½ç¬é—´èå…¥ï¼Œå¼•çˆ†å›¢é˜Ÿåä½œçš„æ— é™èƒ½é‡ï¼", img: "https://images.unsplash.com/photo-1593341641692-aa7a8a7f711b?q=80&w=2574&auto=format&fit=crop" },
        offroad: { title: "å¼•æ“è½°é¸£ï¼Œå°˜åœŸé£æ‰¬ï¼", text: "æƒ³ä½“éªŒä¸€æŠŠç°å®ç‰ˆçš„â€œé€Ÿåº¦ä¸æ¿€æƒ…â€å—ï¼Ÿæ¡ç´§æ–¹å‘ç›˜ï¼Œç©¿è¶Šå´å²–èµ›é“ï¼Œä½“éªŒè‚¾ä¸Šè…ºç´ é£™å‡çš„æè‡´å¿«æ„Ÿï¼", img: "https://images.unsplash.com/photo-1610479593531-c5d9a5b3b3f8?q=80&w=2574&auto=format&fit=crop" },
        party: { title: "å¤œå¹•é™ä¸´ï¼Œå‹è½´å¤§æˆï¼", text: "å½“ç¯ç«ç‚¹ç‡ƒï¼ŒéŸ³ä¹å“èµ·ï¼Œä¸€åœºçŒ®ç»™æ‰€æœ‰å®¶åº­çš„è‰åªæ´¾å¯¹æ­£å¼å¼€å§‹ã€‚å°½æƒ…èˆåŠ¨ï¼Œäº«å—æ­¤åˆ»çš„æƒ¬æ„ä¸è‡ªç”±ï¼", img: "https://images.unsplash.com/photo-1588124239333-594a73f403e3?q=80&w=2574&auto=format&fit=crop" },
        fireworks: { title: "ç‚¹äº®å¤œç©ºï¼Œå®šæ ¼ç’€ç’¨ï¼", text: "ä¸€åœºçŒ®ç»™æ‰€æœ‰å®¶åº­çš„ç’€ç’¨çƒŸèŠ±ç§€ï¼Œå°†ä¸ºä»Šå¤©ç”»ä¸Šæœ€äº®çš„æ„Ÿå¹å·ï¼æŠ¬å¤´ä»°æœ›ï¼Œå°†è¿™ä»½ç¾å¥½æ°¸è¿œçè—ã€‚", img: "https://images.unsplash.com/photo-1533294262438-2895680215a2?q=80&w=2574&auto=format&fit=crop" },
        crafts: { title: "æ…¢æ—¶å…‰ï¼Œäº²æ‰‹ä½œï¼", text: "é™ä¸‹å¿ƒï¼Œä¸å®¶äººå…±åˆ›æ¸©é¦¨ã€‚è¿™é‡Œæ˜¯é‡Šæ”¾åˆ›æ„çš„è‰ºæœ¯å¤©åœ°ã€‚äº²æ‰‹åˆ¶ä½œä¸€ä»¶å°ç‰©ï¼ŒæŠŠå®¶åº­æ—¥çš„ä¸“å±å›å¿†å’Œæ¸©åº¦ä¸€èµ·å¸¦å›å®¶ã€‚", img: "https://images.unsplash.com/photo-1513364776144-60967b0f800f?q=80&w=2671&auto=format&fit=crop" },
        picking: { title: "å¥”è·‘å§ï¼Œéƒ½å¸‚å†œå¤«ï¼", text: "é›†ç»“ï¼æ ¹æ®ç¥ç§˜ä»»åŠ¡å¡ï¼Œå†²å‘ç”°é‡ï¼Œå¯»æ‰¾æœ€æ–°é²œçš„æˆ˜åˆ©å“ã€‚é€Ÿåº¦æœ€å¿«çš„é˜Ÿä¼ï¼Œå°†èµ¢å¾—ä¸°æ”¶çš„è£è€€ï¼", img: "https://images.unsplash.com/photo-1567357504313-264259336946?q=80&w=2574&auto=format&fit=crop" }
    };

    const ACTIVITY_DATA = {
        fun: {
            title: "ã€Œè¶£ã€Â· å¥‡æƒ³ä¸–ç•Œ",
            items: [
                { id: 'fun-1', title: 'é›€ç¥äº‰éœ¸èµ›', subtitle: 'å·¨å‹éº»å°†ï¼Œå…¨å®¶å¼€æ ', desc: 'ä¸æ­¢æ˜¯æ‰‹æ°”ï¼Œæ›´æ˜¯éœ¸æ°”ï¼åœ¨æ”¾å¤§çš„ä¸–ç•Œé‡Œï¼Œè¿ç­¹å¸·å¹„ï¼Œä½“éªŒå·¨å‹éº»å°†å’Œä¸Šæµ·æ•²éº»çš„ä¹è¶£ï¼Œçœ‹è°æ‰æ˜¯çœŸæ­£çš„éº»å›éœ¸ä¸»ï¼', img: 'https://placehold.co/786x384/facc15/333?text=å¤´å›¾-6.5.1', thumb: 'https://placehold.co/128x128/facc15/333?text=ç¼©ç•¥å›¾-6.5.1', rules: 'åƒéº»å›é«˜æ‰‹ä¸€æ ·å¯¹å†³ï¼è§„åˆ™ï¼š4äººä¸€æ¡Œï¼Œå·¨å‹éº»å°†ç‰Œï¼Œèƒ¡ç‰Œå¾—åˆ†ã€‚åˆ«ç¢°å€’ç‰Œå †å“¦ï¼Œä¸ç„¶å…¨å®¶ç¬‘ç¿»å¤©ï¼é™æ—¶20minï¼Œå…ˆèƒ¡è€…èƒœã€‚' },
                { id: 'fun-2', title: 'ç–¯ç‹‚å¡ä¸è½¦', subtitle: 'ä½“éªŒé€Ÿåº¦çš„å¿«æ„Ÿ', desc: 'æ²¹é—¨è¸©åˆ°åº•ï¼Œçƒ¦æ¼å…¨ç”©æ‰ï¼æ¥ä¸€åœºå…¨å®¶äººçš„é€Ÿåº¦ä¸æ¿€æƒ…ï¼Œå®‰å…¨èµ›é“ï¼Œæ— é™å°–å«ï¼', img: 'https://placehold.co/786x384/f97316/333?text=å¤´å›¾-6.5.2', thumb: 'https://placehold.co/128x128/f97316/333?text=ç¼©ç•¥å›¾-6.5.2', rules: 'æ²¹é—¨è½°é¸£ï¼Œå¼¯é“è¶…è½¦ï¼è§„åˆ™ï¼šå®‰å…¨å¤´ç›”ä¸Šé˜µï¼Œèµ›é“é™é€Ÿï¼Œæ’å¢™æ‰£åˆ†ã€‚å…¨å®¶ç»„é˜Ÿï¼Œç¬¬ä¸€ä¸ªå†²çº¿æ‹¿å¤§å¥–ï¼åˆ«å¿˜åˆ¹è½¦å“¦~' },
                { id: 'fun-3', title: 'ç”°å›­å°ç«è½¦', subtitle: 'æ‚ é—²è§‚å…‰ä¹‹æ—…', desc: 'å‘œå‘œ~å¼€å¾€æ˜¥å¤©çš„åˆ—è½¦å‘è½¦å•¦ï¼è½½ä¸Šå®¶äººï¼Œç¯æ¸¸ç«¥è¯èˆ¬çš„å†œåº„ï¼Œæ¯ä¸€å¸§éƒ½æ˜¯é£æ™¯ã€‚', img: 'https://placehold.co/786x384/84cc16/333?text=å¤´å›¾-6.5.3', thumb: 'https://placehold.co/128x128/84cc16/333?text=ç¼©ç•¥å›¾-6.5.3', rules: 'æ…¢æ‚ æ‚ ï¼Œçœ‹é£æ™¯ï¼è§„åˆ™ï¼šæ’é˜Ÿä¸Šè½¦ï¼Œåç¨³æ‰¶å¥½ã€‚å°ç«è½¦ç¯æ¸¸ä¸€å‘¨ï¼Œè®°å¾—è·Ÿè·¯è¾¹çš„ç¨»è‰äººæ‰“æ‹›å‘¼å‘€ï¼' },
                { id: 'fun-4', title: 'æ°´ä¸Šç¢°ç¢°èˆ¹', subtitle: 'å¤æ—¥æ¸…å‡‰å¤§ä½œæˆ˜', desc: 'å¤æ—¥ç‚ç‚ï¼Œæ°´ä¸Šå¼€æˆ˜ï¼é©¾é©¶ä½ çš„å°èˆ¹ï¼Œæ’èµ°æ‰€æœ‰ä¸å¼€å¿ƒï¼Œæ¸…å‡‰ä¸€å¤ï¼', img: 'https://placehold.co/786x384/38bdf8/333?text=å¤´å›¾-6.5.4', thumb: 'https://placehold.co/128x128/38bdf8/333?text=ç¼©ç•¥å›¾-6.5.4', rules: 'æ°´ä¸Šå¤§æˆ˜ä¸‰ç™¾å›åˆï¼è§„åˆ™ï¼šç©¿å¥½æ•‘ç”Ÿè¡£ï¼Œä¸è®¸ç«™ç«‹ã€‚ç›®æ ‡æ˜¯æ’å‡»å¯¹æ–¹èˆ¹åªçš„å……æ°”éƒ¨åˆ†ï¼Œåˆ«æ’è‡ªå·±äººå“¦ï¼' },
            ]
        },
        win: {
            title: "ã€Œèµ¢ã€Â· å¡è·¯é‡Œæˆ˜åœº",
            items: [
                { id: 'win-1', title: 'è¿›å‡»çš„è·³è¿œ', subtitle: 'è¿æ°”ä¸å‹‡æ°”çš„å¯¹å†³', desc: 'ç‹­è·¯ç›¸é€¢å‹‡è€…èƒœï¼ä¸€æ­¥ä¸€è·³ï¼Œä¸€çŒœä¸€å†³ï¼Œé€šå¾€èƒœåˆ©çš„è·¯ä¸Šï¼Œä¸æ­¢éœ€è¦å¤§é•¿è…¿ï¼Œæ›´éœ€è¦å¥½è¿æ°”ï¼', img: 'https://placehold.co/786x384/ef4444/333?text=å¤´å›¾-6.6.1', thumb: 'https://placehold.co/128x128/ef4444/333?text=ç¼©ç•¥å›¾-6.6.1', rules: 'è·³åˆ°â€œå¯¹æ‰‹â€é¢å‰ï¼ŒçŸ³å¤´å‰ªåˆ€å¸ƒï¼è§„åˆ™ï¼šè¾“äº†å°±æ¢é˜Ÿå‹ä»èµ·ç‚¹é‡æ¥ï¼Œèµ¢äº†ç»§ç»­è·³ã€‚è°å…ˆå é¢†å¯¹æ–¹èµ·ç‚¹åŒºè°å°±èµ¢ï¼' },
                { id: 'win-2', title: 'å·¨å‹æ’çƒå¯¹æŠ—èµ›', subtitle: 'è¶…ä¹æƒ³è±¡çš„å›¢é˜Ÿä¹è¶£', desc: 'å›¢ç»“å°±æ˜¯åŠ›é‡ï¼é¢å¯¹è¿™ä¸ªåºç„¶å¤§ç‰©ï¼Œæ¯ä¸€æ¬¡æ‰˜ä¸¾éƒ½å‡èšç€å›¢é˜Ÿçš„å¿ƒè·³ã€‚å¾—åˆ†çš„ç¬é—´ï¼Œç‡ƒçˆ†å…¨åœºï¼', img: 'https://placehold.co/786x384/f97316/333?text=å¤´å›¾-6.6.2', thumb: 'https://placehold.co/128x128/f97316/333?text=ç¼©ç•¥å›¾-6.6.2', rules: 'è¿™ä¸ªæ’çƒæœ‰ç‚¹å¤§ï¼è§„åˆ™ï¼šå›¢é˜Ÿåä½œï¼ŒæŠŠçƒæ‹è¿‡ç½‘ï¼Œè½åœ°å¾—åˆ†ã€‚å°å¿ƒï¼Œåˆ«è¢«çƒç ¸åˆ°ï¼Œå®ƒçœŸçš„å¾ˆå¤§ï¼' },
            ]
        },
        diy: {
            title: "ã€Œä½œã€Â· æ…¢æ—¶å…‰å·¥åŠ",
            items: [
                 { id: 'diy-1', title: 'åŸƒåŠé©¬èµ›å…‹ç¯', subtitle: 'åˆ¶ä½œä½ çš„ä¸“å±è‰ºæœ¯å“', desc: 'äº²æ‰‹æ‹¼è´´äº”å½©æ–‘æ–“çš„ç»ç’ƒç‰‡ï¼Œåœ¨å…‰å½±äº¤é”™ä¸­ï¼Œæ‰“é€ ä¸€ç›å……æ»¡å¼‚åŸŸé£æƒ…çš„åœŸè€³å…¶é©¬èµ›å…‹ç¯ã€‚', img: 'https://placehold.co/786x384/c084fc/333?text=å¤´å›¾-6.7.1', thumb: 'https://placehold.co/128x128/c084fc/333?text=ç¼©ç•¥å›¾-6.7.1', rules: 'ä½“éªŒåœŸè€³å…¶çš„æµªæ¼«ï¼è§„åˆ™ï¼šé¢†å–ææ–™åŒ…ï¼ŒæŒ‰ç…§å›¾çº¸æˆ–è‡ªç”±å‘æŒ¥ï¼Œå°†å½©è‰²ç»ç’ƒç‰‡ç²˜è´´åœ¨ç¯ç½©ä¸Šï¼Œæœ€åç”±å·¥ä½œäººå‘˜å¸®ä½ çŒæµ†å›ºå®šã€‚' },
                 { id: 'diy-2', title: 'æ‰‹ç»˜é£é“ƒ', subtitle: 'æç»˜å¤æ—¥çš„å£°éŸ³', desc: 'ç”¨ç”»ç¬”åœ¨æ¸…è„†çš„ç»ç’ƒé£é“ƒä¸Šæç»˜å¿ƒæƒ…ï¼Œåˆ›ä½œä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„å¤æ—¥é£é“ƒï¼Œè®©æ¸…é£å¸¦å»ä½ çš„ç¥ç¦ã€‚', img: 'https://placehold.co/786x384/a78bfa/333?text=å¤´å›¾-6.7.2', thumb: 'https://placehold.co/128x128/a78bfa/333?text=ç¼©ç•¥å›¾-6.7.2', rules: 'ç”»å‡ºå¤å¤©çš„å£°éŸ³ï¼è§„åˆ™ï¼šé€‰æ‹©ä½ å–œæ¬¢çš„ç»ç’ƒé£é“ƒï¼Œç”¨ç‰¹åˆ¶é¢œæ–™åœ¨ä¸Šé¢ä½œç”»ã€‚ç”»å®Œåè‡ªç„¶é£å¹²ï¼Œå°±å¯ä»¥å¸¦èµ°è¿™ä»½ç‹¬ä¸€æ— äºŒçš„çºªå¿µå“ã€‚' },
            ]
        },
    };

    class H5App {
        constructor(rootId) {
            this.root = document.getElementById(rootId);
            this.appTemplate = document.getElementById('app-template');
            this.root.innerHTML = this.appTemplate.innerHTML;
            
            this.modal = document.getElementById('customModal');
            this.exploreModal = document.getElementById('exploreModal');

            this.state = {
                currentUser: null,
                currentPage: 'splashPage',
                currentScratchType: null,
                registrationData: null,
                tournamentRegistrationData: null,
            };

            this.init();
        }

        getEl(dataId) {
            return document.querySelector(`[data-id="${dataId}"]`);
        }
        getAllEl(selector) {
            return document.querySelectorAll(selector);
        }

        init() {
            this.loadState();
            this.attachEventListeners();
            
            if (this.state.currentUser) {
                this.showPage('mapPage');
            } else {
                this.showPage('splashPage');
            }
        }

        attachEventListeners() {
            document.body.addEventListener('click', (e) => {
                const target = e.target.closest('[data-action]');
                if (!target) return;
                const action = target.dataset.action;
                if (typeof this[action] === 'function') {
                    this[action](target);
                }
            });
        }
        
        showPage(target) {
            const pageId = typeof target === 'string' ? target : target.dataset.page;
            if(!pageId) return;

            this.state.currentPage = pageId;
            this.getAllEl('.page').forEach(p => p.style.display = 'none');
            const targetPage = this.root.querySelector(`#${pageId}`);
            
            if (targetPage) {
                targetPage.style.display = 'flex';
            }
            this.root.parentElement.scrollTo(0, 0);

            if (pageId === 'registrationPage' && this.state.currentUser) {
                this.populateRegistrationForm();
            }
             if (pageId === 'badmintonIntroPage') {
                this.updateBadmintonCounts();
            }
        }
        
        saveState() {
            localStorage.setItem('lillyFamilyDayState', JSON.stringify(this.state));
        }

        loadState() {
            const savedState = localStorage.getItem('lillyFamilyDayState');
            if (savedState) {
                this.state = JSON.parse(savedState);
            }
        }

        verifyEmployee() {
            const id = this.getEl('employeeIdInput').value.trim();
            const name = this.getEl('employeeNameInput').value.trim();
            const phone = this.getEl('employeePhoneInput').value.trim();

            if (id && name && phone) {
                this.state.currentUser = { id, name, phone };
                this.saveState();
                this.showPage('mapPage');
            } else {
                 this.showModal('æç¤º', 'è¯·å¡«å†™æ‰€æœ‰éªŒè¯ä¿¡æ¯ã€‚');
            }
        }
        
        populateRegistrationForm() {
            // ... (Implementation as before)
        }

        submitRegistration() {
            // ... (Implementation as before)
        }

        updateSuccessPage() {
            if (!this.state.registrationData || !this.state.currentUser) return;
            // ... (Implementation as before)
        }

        showMyBookings() {
            if (this.state.registrationData) {
                this.updateSuccessPage();
                this.showPage('successPage');
            } else {
                this.showModal('æç¤º', 'æ‚¨è¿˜æ²¡æœ‰æŠ¥åå®¶åº­æ—¥æ´»åŠ¨ï¼Œè¯·å…ˆæŠ¥åã€‚');
            }
        }

        updateMyBookingsPage() {
           // ... (Implementation as before)
        }

        addFamilyMemberForm(memberData = {}) {
            // ... (Implementation as before)
        }

        removeFamilyMember(target) {
            target.closest('.family-member-form').remove();
        }

        updateTransportInfo(busSelection = null) {
            // ... (Implementation as before)
        }
        
        showModal(title, text, imgSrc = null) {
            this.modal.querySelector('.custom-modal-title').textContent = title;
            this.modal.querySelector('.custom-modal-text').textContent = text;
            const imgEl = this.modal.querySelector('[data-id="modalImage"]');
            
            if (imgSrc) {
                imgEl.src = imgSrc;
                imgEl.parentElement.style.display = 'block';
            } else {
                 imgEl.parentElement.style.display = 'none';
            }
            
            this.modal.classList.add('visible');
            this.modal.querySelector('[data-id="modalCloseBtn"]').onclick = () => this.hideModal();
        }

        hideModal() {
            this.modal.classList.remove('visible');
        }

        showHighlight(target) {
            const highlightKey = target.dataset.highlight;
            const data = HIGHLIGHT_DATA[highlightKey];
            if (data) {
                this.showModal(data.title, data.text, data.img);
            }
        }
        
        showPhotoAlbum() {
            this.showModal('æ•¬è¯·æœŸå¾…', 'â€œç²¾å½©ç¬é—´â€äº‘ç›¸å†ŒåŠŸèƒ½å°†åœ¨æ´»åŠ¨å½“æ—¥ä¸Šçº¿ï¼Œä¸ºæ‚¨è®°å½•æ¯ä¸€ä¸ªæ¬¢ä¹æ—¶åˆ»ï¼');
        }

        openExploreModal() {
            this.exploreModal.classList.add('visible');
        }
        closeExploreModal() {
            this.exploreModal.classList.remove('visible');
        }

        showScratchPage(target) {
            const type = target.dataset.type;
            this.state.currentScratchType = type;
            const data = ACTIVITY_DATA[type];
            this.getEl('scratchTitle').textContent = data.title;
            const container = this.getEl('activityListContainer');
            container.innerHTML = data.items.map(item => `
                <div data-action="showItemDetail" data-item-id="${item.id}" class="flex items-center bg-white rounded-lg p-4 cursor-pointer hover:bg-gray-200 transition">
                    <img src="${item.thumb}" alt="${item.title}" class="w-16 h-16 rounded-md object-cover flex-shrink-0">
                    <div class="ml-4">
                        <h4 class="font-bold font-ringside">${item.title}</h4>
                        <p class="text-sm text-gray-600">${item.subtitle}</p>
                    </div>
                </div>
            `).join('');
            this.closeExploreModal();
            this.showPage('scratchPage');
            this.initScratchCard();
        }
        
        closeScratchPage() {
            this.openExploreModal();
        }

        initScratchCard() {
            // ... (Implementation as before)
        }
        
        showItemDetail(target) {
            // ... (Implementation as before)
        }
        
        handleBadmintonRegistration(event) {
             event.preventDefault();
        }
        updateBadmintonCounts() {
            // ... (Implementation as before)
        }
        showBadmintonRegPage(target) {
             if (!this.state.registrationData) {
                this.showModal('æŠ¥åé™åˆ¶', 'è¯·æ‚¨å…ˆå®Œæˆå®¶åº­æ—¥æ´»åŠ¨æŠ¥åï¼Œæ‰èƒ½æŠ¥åç¾½æ¯›çƒå¤§èµ›å“¦ï¼');
                return;
            }
            this.showPage(target.dataset.page);
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        new H5App('app-container');
    });
</script>
</body>
</html>

